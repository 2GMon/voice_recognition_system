<!-- vim: foldmethod=marker
-->
<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>reveal.js - The HTML Presentation Framework</title>

		<meta name="description" content="フリーソフトでつくる音声認識システム 4章">
		<meta name="author" content="2GMon">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="../css/reveal.min.css">
		<link rel="stylesheet" href="../css/theme/default.css" id="theme">
		<link rel="stylesheet" href="../css/2gmon.css">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="../lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = '../css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>

		<!--[if lt IE 9]>
		<script src="../lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
                <section>
                    <h3>フリーソフトでつくる音声認識システム</h3>
                    <h3>6章</h3>
                    <p>
                    <small>Created by <a href="https://twitter.com/2GMon">2GMon</a></small>
                    </p>
                </section>

                <section>
                    <h3>話の流れ</h3>

                    <ul>
                        <li>基本的な識別の限界</li>
                        <li>サポートベクトルマシン(SVM)</li>
                        <li>ニューラルネットワーク</li>
                    </ul>
                </section>

                <section>
                    <section>
                        <h3>基本的な識別の限界</h3>
                    </section>
                    <section>
                        <p>4, 5章で識別の基本的な理論をカバーした</p>
                        <ul>
                            <li>誤りなく識別できる決定境界を見つける方法<ul>
                                    <li>パーセプトロン</li></ul></li>
                            <li>誤差を最小にする決定境界を見つける方法<ul>
                                    <li>Widrow-Hoffの学習規則</li></ul></li>
                        </ul>
                    </section>
                    <section>
                        <p>パーセプトロンやWidrow-Hoffの学習規則には限界がある</p>
                        <ul>
                            <li>パーセプトロン<ul>
                                    <li>線形分離不可能な学習データに対して停止しない</li></ul></li>
                            <li>Widrow-Hoffの学習規則<ul>
                                    <li>学習データが線形分離可能な場合、見つかった決定境界が必ず誤識別しないといえない</li></ul></li>
                        </ul>
                    </section>
                </section>

                <section>
                    <section>
                        <h3>サポートベクトルマシン(SVM)</h3>
                    </section>

                    <section>
                        <p>パーセプトロンの問題は大きく2つある</p>
                        <ul>
                            <li>線形分離不可能な場合に停止しない</li>
                            <li>誤識別0となる決定境界が見つかっても、未知のデータに通用するとは限らない</li>
                        </ul>
                    </section>

                    <section>
                        <p>見つかった決定境界が未知のデータにも通用するかわからない、という問題について考える</p>
                        <p class="fragment">パーセプトロンの場合、誤識別が0になる領域のどこに決定境界がひかれるのかわからない</p>
                        <p class="fragment">未知のデータに対する識別率は、領域ギリギリよりも真ん中辺りが良さそう</p>
                        <p>
                            <span class="fragment">この真ん中を決めるのがSVM</span>
                        <!-- {{{ -->
                        <svg width="320" height="320" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" style="float: right;">
                            <!-- Created with SVG-edit - http://svg-edit.googlecode.com/ -->

                            <g>
                            <title>レイヤ 0</title>
                            <rect stroke-opacity="0" id="svg_23" height="341" width="353" y="-14" x="-20" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="3" stroke="#000000" fill="#ffffff"/>
                            <rect id="svg_24" height="0" width="1" y="219" x="-116" stroke-opacity="0" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="3" stroke="#000000" fill="#ffffff"/>
                            </g>
                            <g>
                            <title>Layer 1</title>
                            <g id="svg_17" transform="rotate(180, 236.5, 150)">
                            <circle fill="#999999" stroke="#000000" cx="241.75" cy="131" r="5.38672" id="svg_9"/>
                            <circle fill="#999999" stroke="#000000" cx="279.75" cy="122" r="5.38672" id="svg_10"/>
                            <circle fill="#999999" stroke="#000000" cx="279.75" cy="158" r="5.38672" id="svg_11"/>
                            <circle fill="#999999" stroke="#000000" cx="215.25" cy="138" r="5.38672" id="svg_12"/>
                            <circle fill="#999999" stroke="#000000" cx="217.25" cy="207" r="5.38672" id="svg_13"/>
                            <circle fill="#999999" stroke="#000000" cx="237.25" cy="99" r="5.38672" id="svg_14"/>
                            <circle fill="#999999" stroke="#000000" cx="238.25" cy="161" r="5.38672" id="svg_15"/>
                            <circle fill="#999999" stroke="#000000" cx="193.25" cy="93" r="5.38672" id="svg_16"/>
                            </g>
                            <g id="svg_18">
                            <circle fill="#000000" stroke="#000000" fill-opacity="0" cx="79" cy="160" r="5.38672" id="svg_1"/>
                            <circle fill="#000000" stroke="#000000" fill-opacity="0" cx="117" cy="151" r="5.38672" id="svg_2"/>
                            <circle fill="#000000" stroke="#000000" fill-opacity="0" cx="117" cy="187" r="5.38672" id="svg_3"/>
                            <circle fill="#000000" stroke="#000000" fill-opacity="0" cx="52.5" cy="167" r="5.38672" id="svg_4"/>
                            <circle fill="#000000" stroke="#000000" fill-opacity="0" cx="54.5" cy="236" r="5.38672" id="svg_5"/>
                            <circle fill="#000000" stroke="#000000" fill-opacity="0" cx="74.5" cy="128" r="5.38672" id="svg_6"/>
                            <circle fill="#000000" stroke="#000000" fill-opacity="0" cx="75.5" cy="190" r="5.38672" id="svg_7"/>
                            <circle fill="#000000" stroke="#000000" fill-opacity="0" cx="30.5" cy="122" r="5.38672" id="svg_8"/>
                            </g>
                            <foreignObject x="5" y="150" width="50" height="50">
                            <span style=" color: black;">$\omega_1$</span>
                            </foreignObject>
                            <foreignObject x="270" y="120" width="50" height="50">
                            <span style=" color: black;">$\omega_2$</span>
                            </foreignObject>
                            </g>
                            <g>
                            <title>レイヤ 2</title>
                            <path opacity="0.4" id="svg_19" d="m4,48l115,95l-2,49l-118,136l349,-2c0,0 -5,-35 -4,-35c1,0 -154,-107 -154,-107c0,0 0,-50 0,-50c0,0 109,-139 109,-139c0,0 -357,-7 -357,-7c0,0 62,60 62,60z" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="null" stroke="#000000" fill="#999999"/>
                            </g>
                            <g>
                            <title>レイヤ 3</title>
                            <line id="svg_20" y2="323.00001" x2="162" y1="-3.00002" x1="131" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="3" stroke="#000000" fill="none"/>
                            <line id="svg_21" y2="293" x2="322" y1="27" x1="-4" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="3" stroke="#000000" fill="none"/>
                            <line id="svg_22" y2="328" x2="187" y1="-1" x1="187" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="3" stroke="#000000" fill="none"/>
                            </g>
                        </svg>
                        <!-- }}} -->
                        </p>
                    </section>

                    <section>
                        <h3>SVMの概要</h3>
                        <p>k-NN法と同様に、決定境界を決める問題を、学習データの中からプロトタイプを選ぶ問題に置き換える</p>
                        <p class="fragment">決定境界を決めるデータをサポートベクトルとよぶ</p>
                        <p class="fragment">各クラスのサポートベクトルと、決定境界の距離をマージンとよぶ</p>
                        <p class="fragment">マージンが最大になる決定境界を得る</p>
                        <p class="fragment">
                        <!-- {{{ -->
<svg width="320" height="320" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
 <!-- Created with SVG-edit - http://svg-edit.googlecode.com/ -->

 <g>
  <title>レイヤ 0</title>
  <rect fill="#ffffff" stroke="#000000" stroke-width="3" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="-20" y="-14" width="353" height="341" id="svg_23" stroke-opacity="0"/>
  <rect fill="#ffffff" stroke="#000000" stroke-width="3" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" stroke-opacity="0" x="-116" y="219" width="1" height="0" id="svg_24"/>
 </g>
 <g>
  <title>Layer 1</title>
  <g id="svg_17" transform="rotate(180, 236.5, 150)">
   <circle fill="#999999" stroke="#000000" cx="241.75" cy="131" r="5.38672" id="svg_9"/>
   <circle fill="#999999" stroke="#000000" cx="279.75" cy="122" r="5.38672" id="svg_10"/>
   <circle fill="#999999" stroke="#000000" cx="279.75" cy="158" r="5.38672" id="svg_11"/>
   <circle fill="#999999" stroke="#000000" cx="215.25" cy="138" r="5.38672" id="svg_12"/>
   <circle fill="#999999" stroke="#000000" cx="217.25" cy="207" r="5.38672" id="svg_13"/>
   <circle fill="#999999" stroke="#000000" cx="237.25" cy="99" r="5.38672" id="svg_14"/>
   <circle fill="#999999" stroke="#000000" cx="238.25" cy="161" r="5.38672" id="svg_15"/>
   <circle fill="#999999" stroke="#000000" cx="193.25" cy="93" r="5.38672" id="svg_16"/>
  </g>
  <g id="svg_18">
   <circle fill="#000000" stroke="#000000" fill-opacity="0" cx="79" cy="160" r="5.38672" id="svg_1"/>
   <circle fill="#000000" stroke="#000000" fill-opacity="0" cx="117" cy="151" r="5.38672" id="svg_2"/>
   <circle fill="#000000" stroke="#000000" fill-opacity="0" cx="117" cy="187" r="5.38672" id="svg_3"/>
   <circle fill="#000000" stroke="#000000" fill-opacity="0" cx="52.5" cy="167" r="5.38672" id="svg_4"/>
   <circle fill="#000000" stroke="#000000" fill-opacity="0" cx="54.5" cy="236" r="5.38672" id="svg_5"/>
   <circle fill="#000000" stroke="#000000" fill-opacity="0" cx="74.5" cy="128" r="5.38672" id="svg_6"/>
   <circle fill="#000000" stroke="#000000" fill-opacity="0" cx="75.5" cy="190" r="5.38672" id="svg_7"/>
   <circle fill="#000000" stroke="#000000" fill-opacity="0" cx="30.5" cy="122" r="5.38672" id="svg_8"/>
  </g>
  <circle id="svg_19" r="9.84766" cy="151" cx="117" fill-opacity="0" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="#000000"/>
  <circle id="svg_20" r="9.84766" cy="178" cx="193.5" fill-opacity="0" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="#000000"/>
  <circle id="svg_21" r="9.84766" cy="142" cx="193.5" fill-opacity="0" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="#000000"/>
  <circle id="svg_22" r="9.84766" cy="187" cx="117" fill-opacity="0" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="#000000"/>
 </g>
 <g>
  <title>レイヤ 2</title>
  <line id="svg_25" y2="328.0058" x2="156" y1="-17" x1="156" fill-opacity="0" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="3" stroke="#000000" fill="none"/>
  <line id="svg_26" y2="331.65225" x2="117" y1="-19" x1="117" fill-opacity="0" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="5,5" stroke="#000000" fill="none"/>
  <line id="svg_27" y2="334.32608" x2="193.5" y1="-16.32617" x1="193.5" fill-opacity="0" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="5,5" stroke="#000000" fill="none"/>
 </g>
</svg>
                        <!-- }}} -->
                        </p>
                    </section>

                    <section>
                        <p>学習データ $$ X = \{ {\bf x}_1, \cdots , {\bf x}_n \} $$</p>
                        <p>正解クラスラベル $$ \{ y_1, \cdots , y_n \} (y_i = 1({\bf x}_i \in X_1), y_i = -1({\bf x}_i \in X_2)) $$</p>
                        <p>決定境界 $$ g_i({\bf x}) = {\bf w}^T {\bf x} + w_0 = 0 $$</p>
                    </section>

                    <section>
                        <p>マージンを最大化するという問題は、サポートベクトルと決定境界の距離を最大化するということ</p>
                        <p>点と面の距離の公式から、サポートベクトル${\bf x}_i$と決定境界$g_i({\bf x})$の距離は
                        $$ \min_{i = 1, \cdots, n} \frac{|{\bf w}^T {\bf x}_i + w_0|}{||m||} $$</p>
                    </section>

                    <section>
                        <h3>点と面の距離の公式</h3>
                        <p>点$(x_1, y_1)$と平面$ax+by+c=0$との距離$d$は
                        $$ d = \frac{|ax_1+by_1+c|}{\sqrt{a^2+b^2}} $$</p>
                    </section>

                    <section>
                        <p>決定境界の${\bf w}$や$w_0$を定数バイしても超平面は変わらないので、以下のような制約を設けられる
                        $$ \min_{i = 1, \cdots, n} |{\bf w}^T {\bf x}_i + w_0| = 1$$</p>
                        <p>よって、サポートベクトルと決定境界の距離は以下のようになる
                        $$ \min_{i = 1, \cdots, n} \frac{|{\bf w}^T {\bf x}_i + w_0|}{||m||} = \frac {1}{||{\bf w}||} $$</p>
                        <p>マージンを最大化するという問題は$||{\bf w}||$を最小化するという問題になる</p>
                    </section>

                    <section>
                        <p>誤識別が起こらない範囲で$||{\bf w}||$を最小化する必要がある</p>
                        <p>誤識別が起こらないという制約は以下のように設けられる
                        $$ y_i({\bf w}^T{\bf x}_i + w_0) \geq 1 \;\; (i = 1, \cdots, n) $$</p>
                    </section>

                    <section>
                        <p>このように一定の条件が与えられたもとでの最小化問題はラグランジュの未定乗数法で解くことができる</p>
                        <p>$||{\bf w}||^2$の最小化問題は、ラグランジュ係数$\alpha_i$を導入して、以下の関数$L$の最小値を求める問題に置き換えられる
                        $$ L({\bf w}, w_0, \alpha) = \frac{1}{2}||{\bf w}||^2 - \sum_{i=1}^n \alpha_i(y_i({\bf w}^T{\bf x}_i + w_0) - 1) $$</p>
                    </section>

                    <section>
                        <h3>ラグランジュの未定乗数法</h3>
                        <p>$g(x, y)=0$という条件の下で、$z=f(x,y)$の最大値(or 最小値)を求める問題は、$L=f(x,y) - \lambda g(x,y)$という新しい関数を導入し、
                        この関数の極値を求めるという問題に置き換えることができる</p>
                    </section>

                    <section>
                        <p>最小値では$L$の勾配が0になるので、以下の式が成り立つ
                        $$ \begin{align} \frac{\partial L}{\partial w_0} = 0 & \Rightarrow \sum_{i=1}^n\alpha_i y_i = 0 \\
                                         \frac{\partial L}{\partial {\bf w}} = 0 & \Rightarrow {\bf w} = \sum_{i=1}^n\alpha_i y_i {\bf x}_i \end{align}$$</p>
                        <p>$ L({\bf w}, w_0, \alpha) = \frac{1}{2}||{\bf w}||^2 - \sum_{i=1}^n \alpha_i(y_i({\bf w}^T{\bf x}_i + w_0) - 1) $に代入して
                        $L(\alpha) = \sum_{i=1}^n\alpha_i - \frac{1}{2} \sum_{i,j=1}^n \alpha_i \alpha_j y_i y_j {\bf x}_i^T {\bf x}_j $を得る
                        (第1項と第2項を入れ替え、符号を逆にしてある)</p>
                    </section>

                    <section>
                        <p>$L$の符号が入れ替わったので、$L$を最大化すれば良い</p>
                        <p>これは$\alpha_i$に関する2次計画問題と呼ばれ、数値計算ソフトで簡単に求められる(最急降下法でも可)</p>
                        <p>$ {\bf w} = \sum_{i=1}^n\alpha_i y_i {\bf x}_i $より$\alpha_i = 0$となるデータは${\bf w}$の決定に全く関与しない</p>
                        <p>決定境界$ g_i({\bf x}) = {\bf w}^T {\bf x} + w_0 = 0 $にサポートベクトル$x$を代入すると$w_0$が求まる</p>
                        <p>以上で、線形分離可能な場合はマージンを最大化する決定境界が求まる</p>
                    </section>

                    <section>
                        <p>線形分離可能な場合にパーセプトロンが停止しないという問題について考える</p>
                        <br />
                        <div class="fragment">
                        <p>一般に特徴空間の次元数$d$が大きい場合は、線形分裏面が存在する可能性が高くなる</p>
                        <p>低次元の特徴ベクトルを高次元に写像する方法が考えられる</p>
                        </div>
                    </section>

                    <section>
                        <p>元の空間におけるデータ間の距離関係を保存する方式で高次元に非線形変換しても、その高次元空間上での線形識別器の性能は
                        元の空間の性能を反映することがわかっている</p>
                        <p>なので、元の空間におけるデータ間の距離関係を保存するような非線形写像が見つかれば良い</p>
                    </section>

                    <section>
                        <p>元の特徴空間上の2点${\bf x}, {\bf x}'$の距離に基づいて定義される、ある関数$K({\bf x}, {\bf x}')$を考える</p>
                        <p>この関数はカーネル関数と呼ばれる</p>
                        <p>非線形写像を$\phi$としたときに、以下の関係が成り立つことを仮定すると
                        $$ K({\bf x}, {\bf x}') = \phi ({\bf x})^T \phi ({\bf x}') $$</p>
                        <p>写像後の空間での識別関数は以下のように書くことができる
                        $$ g(\phi ({\bf x})) = {\bf w}^T \phi({\bf x}) + w_0 $$</p>
                        <p>このとき元の空間での2点間の距離が、非線形写像後の空間における内積に反映されるという形式で、近さの情報を保存している</p>
                    </section>

                    <section>
                        <p>${\bf w} = \sum_{i=1}^n\alpha_i y_i {\bf x}_i$より
                        $$ \begin{align} g(\phi ({\bf x})) & = {\bf w}^T \phi({\bf x}) + w_0 \\
                        & = \sum_{i=1}^n\alpha_i y_i \phi({\bf x})^T \phi({\bf x}_i) + w_0 \\
                        & = \sum_{i=1}^n\alpha_i y_i K({\bf x}, {\bf x}_i) + w_0 \end{align} $$</p>
                        <p>$L(\alpha) = \sum_{i=1}^n\alpha_i - \frac{1}{2} \sum_{i,j=1}^n \alpha_i \alpha_j y_i y_j {\bf x}_i^T {\bf x}_j$より、
                        学習も $\sum_{i=1}^n \alpha_i - \frac{1}{2} \sum_{i,j=1}^n \alpha_i \alpha_j y_i y_j K({\bf x}_i, {\bf x}_j)$
                        を最大化するという問題になる</p>
                    </section>

                    <section>
                        <p>識別関数、最大化の式両方から$\phi$が消えているので、カーネル関数$K$さえ定まれば識別面を得ることができる</p>
                        <p>このような、複雑な非線形変換を求める操作を避ける方法をカーネルトリックと呼ぶ</p>
                        <p>カーネル関数が正定値関数という条件を満たすときには、このような非線形変換$\phi$が存在することがわかっている</p>
                    </section>

                    <section>
                        <p>カーネル関数の例として、以下のようなものがある</p>
                        <ul>
                            <li>多項式カーネル$$ K({\bf x}, {\bf x}') = ({\bf x}^T {\bf x}' + 1)^p \;\; (p : 自然数) $$</li>
                            <li>ガウシアンカーネル$$ K({\bf x}, {\bf x}') = exp(- \frac{||{\bf x} - {\bf x}'||^2}{\sigma ^2}) $$</li>
                        </ul>
                    </section>

                    <section>
                        <p>非線形変換後の空間で見つかった線形分離超平面は、元の空間では複雑な非線形曲面に対応する</p>
                        <p>SVMはそのまま多クラスの識別に拡張できないので、2クラス識別問題の組み合わせとして表現する</p>
                    </section>
                </section>

                <section>
                    <h3>ニューラルネットワーク</h3>
                </section>

                <section>
                    <ul>
                        <li>誤差評価に基づく学習の問題点
                            <ul>
                                <li>線形分離可能な場合でも、得られる識別関数で誤識別が0になるとは限らない</li>
                            </ul>
                        </li>
                    </ul>
                    <p>非線形識別関数を用いて誤識別を減らす方法の1つにニューラルネットワークがある</p>
                </section>

                <section>
                    <p>ニューラルネットワークはニューロンの働きをモデル化した閾値論理ユニットを多数結合したもの</p>
                    <p>閾値論理ユニットは受け取った重み付き信号の和が閾値を超えると信号を出力する</p>
                    <!-- {{{ -->
<svg width="480" height="320" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
 <!-- Created with SVG-edit - http://svg-edit.googlecode.com/ -->
 <g>
  <title>Layer 1</title>
  <rect stroke-opacity="0" id="svg_2" height="328.99998" width="487.00001" y="-4.99998" x="-4.50001" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#ffffff"/>
 </g>
 <g>
  <title>レイヤ 2</title>
  <rect id="svg_3" height="31" width="64" y="42" x="86.5" fill-opacity="0" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <rect id="svg_4" height="31" width="64" y="135" x="86.5" fill-opacity="0" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <rect id="svg_5" height="31" width="64" y="235" x="86.5" fill-opacity="0" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <path transform="rotate(90, 59.9575, 58.2124)" id="svg_6" d="m56.95749,58.17266l3,-16.44446l3,16.44446l-1.5,0l0,16.52385l-3,0l0,-16.52385l-1.5,0z" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <path id="svg_7" transform="rotate(90, 59.9575, 102.212)" d="m56.95749,102.17266l3,-16.44446l3,16.44446l-1.5,0l0,16.52385l-3,0l0,-16.52385l-1.5,0z" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <path id="svg_8" transform="rotate(90, 59.9575, 150.212)" d="m56.95749,150.17267l3,-16.44446l3,16.44446l-1.5,0l0,16.52383l-3,0l0,-16.52383l-1.5,0z" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <path id="svg_9" transform="rotate(90, 59.9575, 199.212)" d="m56.95749,199.17267l3,-16.44446l3,16.44446l-1.5,0l0,16.52383l-3,0l0,-16.52383l-1.5,0z" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <path id="svg_10" transform="rotate(90, 59.9575, 251.212)" d="m56.95749,251.17267l3,-16.44446l3,16.44446l-1.5,0l0,16.52383l-3,0l0,-16.52383l-1.5,0z" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <g id="svg_15">
   <ellipse ry="1" rx="1" id="svg_11" cy="94" cx="118" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
   <ellipse id="svg_12" ry="1" rx="1" cy="103" cx="118" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
   <ellipse id="svg_13" ry="1" rx="1" cy="112" cx="118" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  </g>
  <g id="svg_16">
   <ellipse id="svg_17" ry="1" rx="1" cy="190" cx="118" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
   <ellipse id="svg_18" ry="1" rx="1" cy="199" cx="118" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
   <ellipse id="svg_19" ry="1" rx="1" cy="208" cx="118" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  </g>
  <circle id="svg_20" r="22.20361" cy="151" cx="218" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#b2b2b2"/>
  <rect id="svg_22" height="112" width="68" y="95" x="280" fill-opacity="0" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <line transform="rotate(52.5067, 177.796, 90.8277)" id="svg_24" y2="90.82773" x2="219.69231" y1="90.82773" x1="135.89906" fill-opacity="0" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="none"/>
  <path transform="rotate(142.507, 202.728, 124.293)" id="svg_25" d="m199.72844,130.91811l2.99991,-13.25002l3.00009,13.25002l-6,0z" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <path id="svg_27" transform="rotate(90, 187.691, 151.413)" d="m184.69096,158.03795l2.99991,-13.25002l3.00009,13.25002l-6,0z" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <line id="svg_28" y2="152" x2="182.01666" y1="152" x1="152" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="none"/>
  <line id="svg_29" y2="174" x2="208" y1="253" x1="152" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="none"/>
  <path id="svg_30" transform="rotate(33.4399, 205.5, 177.5)" d="m202.5,184.125l2.99991,-13.25l3.00009,13.25l-6,0z" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <path id="svg_31" transform="rotate(90, 273.846, 152.5)" d="m270.84549,159.125l2.99991,-13.25l3.00009,13.25l-6,0z" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <line id="svg_32" y2="153.08706" x2="266.17118" y1="153.08706" x1="241.15452" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="none"/>
  <path id="svg_33" transform="rotate(90, 382.346, 151.5)" d="m379.34549,158.125l2.99991,-13.25l3.00009,13.25l-6,0z" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <line id="svg_34" y2="152.08706" x2="374.67118" y1="152.08706" x1="349.65452" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="none"/>
 </g>
 <g>
  <title>レイヤ 3</title>
  <text xml:space="preserve" text-anchor="middle" font-family="serif" font-size="24" id="svg_39" y="160" x="218" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="0" stroke="#000000" fill="#000000">Σ</text>
  <line id="svg_42" y2="152" x2="340.03998" y1="152" x1="290" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_43" y2="181" x2="316" y1="181" x1="290" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_44" y2="117" x2="341" y1="117" x1="317" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_45" y2="180.78871" x2="316" y1="117" x1="316" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <text transform="matrix(0.565667, 0, 0, 0.6, 140.264, 69.2)" xml:space="preserve" text-anchor="middle" font-family="serif" font-size="24" id="svg_46" y="215" x="285.03656" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="0" stroke="#000000" fill="#000000">0</text>
  <text id="svg_47" transform="matrix(0.565667, 0, 0, 0.6, 140.264, 69.2)" xml:space="preserve" text-anchor="middle" font-family="serif" font-size="24" y="71.66667" x="336.30347" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="0" stroke="#000000" fill="#000000">1</text>
 </g>
 <g display="inline">
  <title>レイヤ 4</title>
  <text transform="matrix(0.567768, 0, 0, 0.6048, -2.06583, 7.6896)" xml:space="preserve" text-anchor="middle" font-family="serif" font-size="24" id="svg_35" y="29.94444" x="48.5512" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="0" stroke="#000000" fill="#000000">入力</text>
  <text id="svg_36" transform="matrix(0.567768, 0, 0, 0.6048, -2.06583, 7.6896)" xml:space="preserve" text-anchor="middle" font-family="serif" font-size="24" y="28.29101" x="208.82793" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="0" stroke="#000000" fill="#000000">重み</text>
  <text id="svg_38" transform="matrix(0.576551, 0, 0, 0.6048, -8.10179, 7.6896)" xml:space="preserve" text-anchor="middle" font-family="serif" font-size="24" y="180.40741" x="402.56905" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="0" stroke="#000000" fill="#000000">和計算</text>
  <text id="svg_40" transform="matrix(0.576551, 0, 0, 0.6048, -8.10179, 7.6896)" xml:space="preserve" text-anchor="middle" font-family="serif" font-size="24" y="124.19048" x="558.66972" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="0" stroke="#000000" fill="#000000">閾値関数</text>
  <text id="svg_41" transform="matrix(0.567768, 0, 0, 0.6048, -2.06583, 7.6896)" xml:space="preserve" text-anchor="middle" font-family="serif" font-size="24" y="178.75397" x="746.01923" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="0" stroke="#000000" fill="#000000">出力</text>
 </g>
 <g>
  <title>レイヤ 5</title>
  <foreignObject x="15" y="25" width="50" height="50">
  <span style="font-size: 60%; color: black;">$x_0$</span>
  </foreignObject>
  <foreignObject x="15" y="120" width="50" height="50">
  <span style="font-size: 60%; color: black;">$x_i$</span>
  </foreignObject>
  <foreignObject x="15" y="220" width="50" height="50">
  <span style="font-size: 60%; color: black;">$x_d$</span>
  </foreignObject>

  <foreignObject x="110" y="25" width="50" height="50">
  <span style="font-size: 60%; color: black;">$w_0$</span>
  </foreignObject>
  <foreignObject x="110" y="120" width="50" height="50">
  <span style="font-size: 60%; color: black;">$w_i$</span>
  </foreignObject>
  <foreignObject x="110" y="220" width="50" height="50">
  <span style="font-size: 60%; color: black;">$w_d$</span>
  </foreignObject>

  <foreignObject x="400" y="120" width="50" height="50">
  <span style="font-size: 60%; color: black;">$g_i({\bf x})$</span>
  </foreignObject>
 </g>
</svg>
                    <!-- }}} -->
                </section>

                <section>
                <p>以下の様な単純な階層構造のものをフィードフォワード型ニューラルネットワークとよぶ</p>
                <p>1を出力する出力層のユニットに対応するクラスが識別結果になる</p>
                <!-- {{{ -->
<svg width="480" height="320" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
 <!-- Created with SVG-edit - http://svg-edit.googlecode.com/ -->

 <g display="inline">
  <title>Layer 1</title>
  <rect stroke-opacity="0" id="svg_2" height="328.99998" width="487.00001" y="-4.99998" x="-4.50001" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#ffffff"/>
 </g>
 <g>
  <title>レイヤ 2</title>
  <rect id="svg_3" height="31" width="64" y="42" x="86.5" fill-opacity="0" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <rect id="svg_4" height="31" width="64" y="135" x="86.5" fill-opacity="0" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <rect id="svg_5" height="31" width="64" y="235" x="86.5" fill-opacity="0" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <circle id="svg_20" r="22.20361" cy="57" cx="246.5" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000" fill-opacity="0"/>
  <circle r="22.20361" cy="149" cx="246.5" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000" fill-opacity="0" id="svg_1"/>
  <circle r="22.20361" cy="252" cx="246.5" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000" fill-opacity="0" id="svg_6"/>
  <circle r="22.20361" cy="57" cx="376.5" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000" fill-opacity="0" id="svg_7"/>
  <circle r="22.20361" cy="149" cx="376.5" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000" fill-opacity="0" id="svg_8"/>
  <circle r="22.20361" cy="252" cx="376.5" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000" fill-opacity="0" id="svg_9"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="152" y1="56" x2="223.00704" y2="56" id="svg_10"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="225" y1="151" x2="152" y2="58" id="svg_11"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="224" y1="256" x2="153" y2="60" id="svg_12"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="152" y1="149" x2="223" y2="149" id="svg_13"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="224" y1="257" x2="152" y2="150" id="svg_14"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="153" y1="150" x2="223" y2="58" id="svg_15"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="152" y1="251" x2="224" y2="60" id="svg_16"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="153" y1="253" x2="223" y2="255" id="svg_17"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="225" y1="152" x2="151" y2="254" id="svg_18"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="270" y1="58" x2="353.02409" y2="58" id="svg_19"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="355" y1="152" x2="270" y2="60" id="svg_21"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="355" y1="254" x2="270" y2="60" id="svg_22"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="270" y1="150" x2="353.00602" y2="150" id="svg_23"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="352" y1="58" x2="270" y2="149" id="svg_24"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="355" y1="253" x2="272" y2="151" id="svg_25"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="353" y1="60" x2="271" y2="253" id="svg_26"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="353" y1="151" x2="270" y2="253.00001" id="svg_27"/>
  <line fill="none" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="270" y1="254" x2="352" y2="254" id="svg_28"/>
 </g>
 <g display="inline">
  <title>レイヤ 4</title>
  <text transform="matrix(0.567768, 0, 0, 0.6048, -2.06583, 7.6896)" xml:space="preserve" text-anchor="middle" font-family="serif" font-size="24" id="svg_35" y="23.33068" x="214.11179" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="0" stroke="#000000" fill="#000000">入力層</text>
  <text id="svg_36" transform="matrix(0.567768, 0, 0, 0.6048, -2.06583, 7.6896)" xml:space="preserve" text-anchor="middle" font-family="serif" font-size="24" y="23.33069" x="437.7947" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="0" stroke="#000000" fill="#000000">中間層</text>
  <text id="svg_41" transform="matrix(0.567768, 0, 0, 0.6048, -2.06583, 7.6896)" xml:space="preserve" text-anchor="middle" font-family="serif" font-size="24" y="24.98412" x="672.04535" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="0" stroke="#000000" fill="#000000">出力層</text>
 </g>
 <g>
  <title>レイヤ 5</title>
 </g>
</svg>
                <!-- }}} -->
                </section>

                <section>
                    <p>各ユニットでの操作は非線形変換で、この場合フィードフォワード型ニューラルネットワークは重みを調整すれば任意の非線形識別面を近似できることがわかっている</p>
                </section>

                <section>
                    <p>中間層から出力層への重みは判別結果と教師信号を比較することで、誤差評価に基づく学習が使える</p>
                    <p>中間層に対応する教師信号は存在しないので、入力層から中間層への重みの学習は別の方法を考える必要がある</p>
                <!-- {{{ -->
<svg width="480" height="320" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
 <!-- Created with SVG-edit - http://svg-edit.googlecode.com/ -->

 <g display="inline">
  <title>Layer 1</title>
  <rect stroke-opacity="0" id="svg_2" height="328.99998" width="487.00001" y="-4.99998" x="-4.50001" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#ffffff"/>
 </g>
 <g>
  <title>レイヤ 2</title>
  <rect id="svg_3" height="31" width="64" y="42" x="86.5" fill-opacity="0" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <rect id="svg_4" height="31" width="64" y="135" x="86.5" fill-opacity="0" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <rect id="svg_5" height="31" width="64" y="235" x="86.5" fill-opacity="0" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000"/>
  <circle id="svg_20" r="22.20361" cy="57" cx="246.5" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000" fill-opacity="0"/>
  <circle r="22.20361" cy="149" cx="246.5" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000" fill-opacity="0" id="svg_1"/>
  <circle r="22.20361" cy="252" cx="246.5" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000" fill-opacity="0" id="svg_6"/>
  <circle r="22.20361" cy="57" cx="376.5" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000" fill-opacity="0" id="svg_7"/>
  <circle r="22.20361" cy="149" cx="376.5" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000" fill-opacity="0" id="svg_8"/>
  <circle r="22.20361" cy="252" cx="376.5" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="2" stroke="#000000" fill="#000000" fill-opacity="0" id="svg_9"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="152" y1="56" x2="223.00704" y2="56" id="svg_10"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="225" y1="151" x2="152" y2="58" id="svg_11"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="224" y1="256" x2="153" y2="60" id="svg_12"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="152" y1="149" x2="223" y2="149" id="svg_13"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="224" y1="257" x2="152" y2="150" id="svg_14"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="153" y1="150" x2="223" y2="58" id="svg_15"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="152" y1="251" x2="224" y2="60" id="svg_16"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="153" y1="253" x2="223" y2="255" id="svg_17"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="225" y1="152" x2="151" y2="254" id="svg_18"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="270" y1="58" x2="353.02409" y2="58" id="svg_19"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="355" y1="152" x2="270" y2="60" id="svg_21"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="355" y1="254" x2="270" y2="60" id="svg_22"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="270" y1="150" x2="353.00602" y2="150" id="svg_23"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="352" y1="58" x2="270" y2="149" id="svg_24"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="355" y1="253" x2="272" y2="151" id="svg_25"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="353" y1="60" x2="271" y2="253" id="svg_26"/>
  <line fill="none" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="353" y1="151" x2="270" y2="253.00001" id="svg_27"/>
  <line fill="none" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="270" y1="254" x2="352" y2="254" id="svg_28"/>
 </g>
 <g display="inline">
  <title>レイヤ 4</title>
  <text transform="matrix(0.567768, 0, 0, 0.6048, -2.06583, 7.6896)" xml:space="preserve" text-anchor="middle" font-family="serif" font-size="24" id="svg_35" y="23.33068" x="214.11179" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="0" stroke="#000000" fill="#000000">入力層</text>
  <text id="svg_36" transform="matrix(0.567768, 0, 0, 0.6048, -2.06583, 7.6896)" xml:space="preserve" text-anchor="middle" font-family="serif" font-size="24" y="23.33069" x="437.7947" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="0" stroke="#000000" fill="#000000">中間層</text>
  <text id="svg_41" transform="matrix(0.567768, 0, 0, 0.6048, -2.06583, 7.6896)" xml:space="preserve" text-anchor="middle" font-family="serif" font-size="24" y="24.98412" x="672.04535" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="0" stroke="#000000" fill="#000000">出力層</text>
 </g>
 <g>
  <title>レイヤ 5</title>
 </g>
</svg>
                <!-- }}} -->
                </section>

                <section>
                    <p>階層的なネットワークの重みを学習する誤差逆伝播法という方法がある</p>
                    <!-- {{{ -->
<svg width="480" height="320" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
 <!-- Created with SVG-edit - http://svg-edit.googlecode.com/ -->

 <g display="inline">
  <title>Layer 1</title>
  <rect fill="#ffffff" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="-4.50001" y="-4.99998" width="487.00001" height="328.99998" id="svg_2" stroke-opacity="0"/>
 </g>
 <g>
  <title>レイヤ 2</title>
  <rect fill="#000000" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" fill-opacity="0" x="86.5" y="42" width="64" height="31" id="svg_3"/>
  <rect fill="#000000" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" fill-opacity="0" x="86.5" y="135" width="64" height="31" id="svg_4"/>
  <rect fill="#000000" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" fill-opacity="0" x="86.5" y="235" width="64" height="31" id="svg_5"/>
  <circle fill-opacity="0" fill="#000000" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="246.5" cy="57" r="22.20361" id="svg_20"/>
  <circle id="svg_1" fill-opacity="0" fill="#000000" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="246.5" cy="149" r="22.20361"/>
  <circle id="svg_6" fill-opacity="0" fill="#000000" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="246.5" cy="252" r="22.20361"/>
  <circle id="svg_7" fill-opacity="0" fill="#000000" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="376.5" cy="57" r="22.20361"/>
  <circle id="svg_8" fill-opacity="0" fill="#000000" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="376.5" cy="149" r="22.20361"/>
  <circle id="svg_9" fill-opacity="0" fill="#000000" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="376.5" cy="252" r="22.20361"/>
  <line id="svg_10" y2="56" x2="223.00704" y1="56" x1="152" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_11" y2="58" x2="152" y1="151" x1="225" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_12" y2="60" x2="153" y1="256" x1="224" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_13" y2="149" x2="223" y1="149" x1="152" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_14" y2="150" x2="152" y1="257" x1="224" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_15" y2="58" x2="223" y1="150" x1="153" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_16" y2="60" x2="224" y1="251" x1="152" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_17" y2="255" x2="223" y1="253" x1="153" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_18" y2="254" x2="151" y1="152" x1="225" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_19" y2="58" x2="353.02409" y1="58" x1="270" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_21" y2="60" x2="270" y1="152" x1="355" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_22" y2="60" x2="270" y1="254" x1="355" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_23" y2="150" x2="353.00602" y1="150" x1="270" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_24" y2="149" x2="270" y1="58" x1="352" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_25" y2="151" x2="272" y1="253" x1="355" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_26" y2="253" x2="271" y1="60" x1="353" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_27" y2="253.00001" x2="270" y1="151" x1="353" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke="#000000" fill="none"/>
  <line id="svg_28" y2="254" x2="352" y1="254" x1="270" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="null" stroke="#000000" fill="none"/>
 </g>
 <g display="inline">
  <title>レイヤ 4</title>
  <text fill="#000000" stroke="#000000" stroke-width="0" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="83.77686" y="26.63756" id="svg_35" font-size="24" font-family="serif" text-anchor="middle" xml:space="preserve" transform="matrix(0.567768, 0, 0, 0.6048, -2.06583, 7.6896)">入力</text>
  <text style="cursor: move;" fill="#000000" stroke="#000000" stroke-width="0" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="772.43847" y="26.63756" font-size="24" font-family="serif" text-anchor="middle" xml:space="preserve" transform="matrix(0.567768, 0, 0, 0.6048, -2.06583, 7.6896)" id="svg_41">教師信号</text>
  <path transform="rotate(90, 118.122, 26.3952)" id="svg_29" d="m112.62249,26.29324l5.5,-42.37504l5.5,42.37504l-2.74999,0l0,42.57903l-5.50001,0l0,-42.57903l-2.75,0z" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="null" stroke="#000000" fill="#000000"/>
  <path id="svg_30" transform="rotate(90, 255.122, 27.3952)" d="m249.6225,27.29324l5.5,-42.37504l5.5,42.37504l-2.75,0l0,42.57903l-5.5,0l0,-42.57903l-2.75,0z" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="null" stroke="#000000" fill="#000000"/>
  <path id="svg_31" transform="rotate(-90, 246.122, 290.395)" fill-opacity="0" d="m240.6225,290.29324l5.5,-42.37505l5.5,42.37505l-2.75,0l0,42.57901l-5.5,0l0,-42.57901l-2.75,0z" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="null" stroke="#000000" fill="#000000"/>
  <path id="svg_32" transform="rotate(-90, 377.122, 291.395)" fill-opacity="0" d="m371.6225,291.29324l5.5,-42.37503l5.5,42.37503l-2.75,0l0,42.57901l-5.5,0l0,-42.57901l-2.75,0z" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" stroke-width="null" stroke="#000000" fill="#000000"/>
  <text style="cursor: move;" id="svg_33" fill="#000000" stroke="#000000" stroke-width="0" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="786.5287" y="489.60054" font-size="24" font-family="serif" text-anchor="middle" xml:space="preserve" transform="matrix(0.567768, 0, 0, 0.6048, -2.06583, 7.6896)">誤差</text>
 </g>
 <g>
  <title>レイヤ 5</title>
  <foreignObject x="40" y="25" width="50" height="50">
  <span style="font-size: 60%; color: black;">$x_0$</span>
  </foreignObject>
  <foreignObject x="40" y="120" width="50" height="50">
  <span style="font-size: 60%; color: black;">$x_i$</span>
  </foreignObject>
  <foreignObject x="40" y="220" width="50" height="50">
  <span style="font-size: 60%; color: black;">$x_d$</span>
  </foreignObject>

  <foreignObject x="420" y="25" width="50" height="50">
  <span style="font-size: 60%; color: black;">$b_0$</span>
  </foreignObject>
  <foreignObject x="420" y="120" width="50" height="50">
  <span style="font-size: 60%; color: black;">$b_i$</span>
  </foreignObject>
  <foreignObject x="420" y="220" width="50" height="50">
  <span style="font-size: 60%; color: black;">$b_d$</span>
  </foreignObject>
 </g>
</svg>
                    <!-- }}} -->
                </section>

                <section>
                    <p>以降では一般化のために、多くの階層からなるネットワークを考える</p>
                    <!-- {{{ -->
<svg width="480" height="320" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
 <!-- Created with SVG-edit - http://svg-edit.googlecode.com/ -->

 <g>
  <title>Layer 1</title>
  <rect fill="#ffffff" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="-6" y="-5" width="491" height="329" id="svg_1"/>
 </g>
 <g display="inline">
  <title>レイヤ 2</title>
  <rect fill="#b2b2b2" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="10" y="5" width="89" height="279" id="svg_2"/>
  <rect fill="#b2b2b2" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="381" y="4" width="89" height="282.00001" id="svg_3"/>
  <text fill="#000000" stroke="#000000" stroke-width="0" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="24" y="298" id="svg_5" font-size="24" font-family="serif" text-anchor="middle" xml:space="preserve"/>
  <text fill="#000000" stroke="#000000" stroke-width="0" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="212.72384" y="307.66667" id="svg_6" font-size="24" font-family="serif" text-anchor="middle" xml:space="preserve" transform="matrix(0.508868, 0, 0, 0.6, -43.2483, 121.6)">1層前のユニット集合</text>
  <text fill="#000000" stroke="#000000" stroke-width="0" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="902.49018" y="307.66667" font-size="24" font-family="serif" text-anchor="middle" xml:space="preserve" transform="matrix(0.508868, 0, 0, 0.6, -43.2483, 121.6)" id="svg_7">1層後のユニット集合</text>
  <circle fill="#ffffff" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="239.5" cy="137" r="79.69803" id="svg_14"/>
  <text fill="#000000" stroke="#000000" stroke-width="0" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="560.55473" y="237.66667" font-size="24" font-family="serif" text-anchor="middle" xml:space="preserve" transform="matrix(0.508868, 0, 0, 0.6, -43.2483, 121.6)" id="svg_16">着目している層のj番目のユニット</text>
 </g>
 <g display="inline">
  <title>レイヤ 3</title>
  <circle fill="#ffffff" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="54.5" cy="49" r="26.40076" id="svg_8"/>
  <circle fill="#ffffff" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="54.5" cy="135" r="26.40076" id="svg_9"/>
  <circle fill="#ffffff" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="54.5" cy="234" r="26.40076" id="svg_10"/>
  <circle fill="#ffffff" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="425.5" cy="50" r="26.40076" id="svg_11"/>
  <circle fill="#ffffff" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="425.5" cy="136" r="26.40076" id="svg_12"/>
  <circle fill="#ffffff" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="425.5" cy="235" r="26.40076" id="svg_13"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="82" y1="49" x2="100" y2="49" id="svg_26"/>
  <rect fill="#000000" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="109" y="33" width="45" height="30" id="svg_17" fill-opacity="0"/>
  <rect fill="#000000" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="109" y="120" width="45" height="30" fill-opacity="0" id="svg_18"/>
  <rect fill="#000000" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="109" y="218" width="45" height="30" fill-opacity="0" id="svg_19"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m99.13501,53.78318l5,-8.75005l5,8.75005l-10,0z" id="svg_23" transform="rotate(90, 104.135, 49.4082)"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m98.13501,139.78317l5,-8.75005l5,8.75005l-10,0z" transform="rotate(90, 103.135, 135.408)" id="svg_24"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m98.13501,238.78317l5,-8.75005l5,8.75005l-10,0z" transform="rotate(90, 103.135, 234.408)" id="svg_25"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="163" y1="137" x2="153.94461" y2="137" id="svg_30"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="154" y1="47" x2="194" y2="112" id="svg_33"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="155" y1="234" x2="194" y2="162" id="svg_34"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="98" y1="136" x2="83" y2="136" id="svg_27"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="82" y1="234" x2="102.02498" y2="234" id="svg_28"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m186.13501,112.78317l5,-8.75005l5,8.75005l-10,0z" transform="rotate(147.785, 191.135, 108.408)" id="svg_31"/>
  <circle fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" fill-opacity="0" cx="195" cy="136" r="23.43075" id="svg_20"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m162.13501,141.78317l5,-8.75005l5,8.75005l-10,0z" transform="rotate(90, 167.135, 137.408)" id="svg_29"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m188.13501,168.78317l5,-8.75005l5,8.75005l-10,0z" transform="rotate(26.0835, 193.135, 164.408)" id="svg_32"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="218" y1="134" x2="249.01612" y2="134" id="svg_36"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m247.13501,137.78317l5,-8.75005l5,8.75005l-10,0z" transform="rotate(90, 252.135, 133.408)" id="svg_35"/>
  <rect fill="#000000" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" fill-opacity="0" x="256" y="97" width="42" height="75" id="svg_21"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="300" y1="134" x2="329.01612" y2="134" id="svg_38"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m323.13501,138.78317l5,-8.75005l5,8.75005l-10,0z" transform="rotate(90, 328.135, 134.408)" id="svg_37"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="358" y1="132" x2="405" y2="70" id="svg_39"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="404" y1="217" x2="357" y2="133" id="svg_40"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="399" y1="134" x2="358" y2="134" id="svg_41"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m400.13501,75.78318l5,-8.75005l5,8.75005l-10,0z" transform="rotate(35.5406, 405.135, 71.4082)" id="svg_42"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m390.13501,137.78317l5,-8.75005l5,8.75005l-10,0z" transform="rotate(90, 395.135, 133.408)" id="svg_43"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m398.13501,219.78317l5,-8.75005l5,8.75005l-10,0z" transform="rotate(150.855, 403.135, 215.408)" id="svg_44"/>
  <text fill="#000000" stroke="#000000" stroke-width="0" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="194" y="144" id="svg_45" font-size="24" font-family="serif" text-anchor="middle" xml:space="preserve">Σ</text>
  <text fill="#000000" stroke="#000000" stroke-width="0" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="380" y="80" id="svg_46" font-size="24" font-family="serif" text-anchor="middle" xml:space="preserve"  transform="matrix(0.507576, 0, 0, 0.558989, 173.914, 57.002)">重み</text>
 </g>
 <g display="inline">
  <title>レイヤ 4</title>
  <foreignObject x="80" y="25" width="50" height="50">
  <span style="font-size: 50%; color: black;">$g_{0p}$</span>
  </foreignObject>
  <foreignObject x="80" y="115" width="50" height="50">
  <span style="font-size: 50%; color: black;">$g_{ip}$</span>
  </foreignObject>
  <foreignObject x="80" y="210" width="50" height="50">
  <span style="font-size: 50%; color: black;">$g_{mp}$</span>
  </foreignObject>

  <foreignObject x="120" y="15" width="50" height="50">
  <span style="font-size: 50%; color: black;">$w_{0j}$</span>
  </foreignObject>
  <foreignObject x="120" y="105" width="50" height="50">
  <span style="font-size: 50%; color: black;">$w_{ij}$</span>
  </foreignObject>
  <foreignObject x="120" y="200" width="50" height="50">
  <span style="font-size: 50%; color: black;">$w_{mj}$</span>
  </foreignObject>

  <foreignObject x="230" y="115" width="50" height="50">
  <span style="font-size: 50%; color: black;">$h_{jp}$</span>
  </foreignObject>

  <foreignObject x="270" y="110" width="90" height="50">
  <span style="font-size: 80%; color: black;">$f$</span>
  </foreignObject>

  <foreignObject x="335" y="100" width="50" height="50">
  <span style="font-size: 50%; color: black;">$g_{jp}$</span>
  </foreignObject>
 </g>
</svg>
                    <!-- }}} -->
                </section>

                <section>
                    <p>学習パターン${\bf x}_p$が入力された時を考える</p>
                    <p>ユニット$i$の出力：$g_{ip}$<br />ユニット$i$からユニット$j$への重み：$w_{ij}$とすると</p>
                    <p>ユニット$j$への入力：$h_{jp} = \sum_i w_{ij} g_{ip}$<br />ユニット$j$の出力：$f$を閾値関数とすると$g_{jp}=f(h_{jp})$</p>
                    <!-- {{{ -->
<svg width="480" height="320" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
 <!-- Created with SVG-edit - http://svg-edit.googlecode.com/ -->

 <g>
  <title>Layer 1</title>
  <rect fill="#ffffff" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="-6" y="-5" width="491" height="329" id="svg_1"/>
 </g>
 <g display="inline">
  <title>レイヤ 2</title>
  <rect fill="#b2b2b2" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="10" y="5" width="89" height="279" id="svg_2"/>
  <rect fill="#b2b2b2" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="381" y="4" width="89" height="282.00001" id="svg_3"/>
  <text fill="#000000" stroke="#000000" stroke-width="0" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="24" y="298" id="svg_5" font-size="24" font-family="serif" text-anchor="middle" xml:space="preserve"/>
  <text fill="#000000" stroke="#000000" stroke-width="0" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="212.72384" y="307.66667" id="svg_6" font-size="24" font-family="serif" text-anchor="middle" xml:space="preserve" transform="matrix(0.508868, 0, 0, 0.6, -43.2483, 121.6)">1層前のユニット集合</text>
  <text fill="#000000" stroke="#000000" stroke-width="0" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="902.49018" y="307.66667" font-size="24" font-family="serif" text-anchor="middle" xml:space="preserve" transform="matrix(0.508868, 0, 0, 0.6, -43.2483, 121.6)" id="svg_7">1層後のユニット集合</text>
  <circle fill="#ffffff" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="239.5" cy="137" r="79.69803" id="svg_14"/>
  <text fill="#000000" stroke="#000000" stroke-width="0" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="560.55473" y="237.66667" font-size="24" font-family="serif" text-anchor="middle" xml:space="preserve" transform="matrix(0.508868, 0, 0, 0.6, -43.2483, 121.6)" id="svg_16">着目している層のj番目のユニット</text>
 </g>
 <g display="inline">
  <title>レイヤ 3</title>
  <circle fill="#ffffff" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="54.5" cy="49" r="26.40076" id="svg_8"/>
  <circle fill="#ffffff" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="54.5" cy="135" r="26.40076" id="svg_9"/>
  <circle fill="#ffffff" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="54.5" cy="234" r="26.40076" id="svg_10"/>
  <circle fill="#ffffff" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="425.5" cy="50" r="26.40076" id="svg_11"/>
  <circle fill="#ffffff" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="425.5" cy="136" r="26.40076" id="svg_12"/>
  <circle fill="#ffffff" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" cx="425.5" cy="235" r="26.40076" id="svg_13"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="82" y1="49" x2="100" y2="49" id="svg_26"/>
  <rect fill="#000000" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="109" y="33" width="45" height="30" id="svg_17" fill-opacity="0"/>
  <rect fill="#000000" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="109" y="120" width="45" height="30" fill-opacity="0" id="svg_18"/>
  <rect fill="#000000" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="109" y="218" width="45" height="30" fill-opacity="0" id="svg_19"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m99.13501,53.78318l5,-8.75005l5,8.75005l-10,0z" id="svg_23" transform="rotate(90, 104.135, 49.4082)"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m98.13501,139.78317l5,-8.75005l5,8.75005l-10,0z" transform="rotate(90, 103.135, 135.408)" id="svg_24"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m98.13501,238.78317l5,-8.75005l5,8.75005l-10,0z" transform="rotate(90, 103.135, 234.408)" id="svg_25"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="163" y1="137" x2="153.94461" y2="137" id="svg_30"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="154" y1="47" x2="194" y2="112" id="svg_33"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="155" y1="234" x2="194" y2="162" id="svg_34"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="98" y1="136" x2="83" y2="136" id="svg_27"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="82" y1="234" x2="102.02498" y2="234" id="svg_28"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m186.13501,112.78317l5,-8.75005l5,8.75005l-10,0z" transform="rotate(147.785, 191.135, 108.408)" id="svg_31"/>
  <circle fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" fill-opacity="0" cx="195" cy="136" r="23.43075" id="svg_20"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m162.13501,141.78317l5,-8.75005l5,8.75005l-10,0z" transform="rotate(90, 167.135, 137.408)" id="svg_29"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m188.13501,168.78317l5,-8.75005l5,8.75005l-10,0z" transform="rotate(26.0835, 193.135, 164.408)" id="svg_32"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="218" y1="134" x2="249.01612" y2="134" id="svg_36"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m247.13501,137.78317l5,-8.75005l5,8.75005l-10,0z" transform="rotate(90, 252.135, 133.408)" id="svg_35"/>
  <rect fill="#000000" stroke="#000000" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" fill-opacity="0" x="256" y="97" width="42" height="75" id="svg_21"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="300" y1="134" x2="329.01612" y2="134" id="svg_38"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m323.13501,138.78317l5,-8.75005l5,8.75005l-10,0z" transform="rotate(90, 328.135, 134.408)" id="svg_37"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="358" y1="132" x2="405" y2="70" id="svg_39"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="404" y1="217" x2="357" y2="133" id="svg_40"/>
  <line fill="none" stroke="#000000" stroke-width="2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x1="399" y1="134" x2="358" y2="134" id="svg_41"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m400.13501,75.78318l5,-8.75005l5,8.75005l-10,0z" transform="rotate(35.5406, 405.135, 71.4082)" id="svg_42"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m390.13501,137.78317l5,-8.75005l5,8.75005l-10,0z" transform="rotate(90, 395.135, 133.408)" id="svg_43"/>
  <path fill="#000000" stroke="#000000" stroke-width="null" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" d="m398.13501,219.78317l5,-8.75005l5,8.75005l-10,0z" transform="rotate(150.855, 403.135, 215.408)" id="svg_44"/>
  <text fill="#000000" stroke="#000000" stroke-width="0" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="194" y="144" id="svg_45" font-size="24" font-family="serif" text-anchor="middle" xml:space="preserve">Σ</text>
  <text fill="#000000" stroke="#000000" stroke-width="0" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="380" y="80" id="svg_46" font-size="24" font-family="serif" text-anchor="middle" xml:space="preserve"  transform="matrix(0.507576, 0, 0, 0.558989, 173.914, 57.002)">重み</text>
 </g>
 <g display="inline">
  <title>レイヤ 4</title>
  <foreignObject x="80" y="25" width="50" height="50">
  <span style="font-size: 50%; color: black;">$g_{0p}$</span>
  </foreignObject>
  <foreignObject x="80" y="115" width="50" height="50">
  <span style="font-size: 50%; color: black;">$g_{ip}$</span>
  </foreignObject>
  <foreignObject x="80" y="210" width="50" height="50">
  <span style="font-size: 50%; color: black;">$g_{mp}$</span>
  </foreignObject>

  <foreignObject x="120" y="15" width="50" height="50">
  <span style="font-size: 50%; color: black;">$w_{0j}$</span>
  </foreignObject>
  <foreignObject x="120" y="105" width="50" height="50">
  <span style="font-size: 50%; color: black;">$w_{ij}$</span>
  </foreignObject>
  <foreignObject x="120" y="200" width="50" height="50">
  <span style="font-size: 50%; color: black;">$w_{mj}$</span>
  </foreignObject>

  <foreignObject x="230" y="115" width="50" height="50">
  <span style="font-size: 50%; color: black;">$h_{jp}$</span>
  </foreignObject>

  <foreignObject x="270" y="110" width="90" height="50">
  <span style="font-size: 80%; color: black;">$f$</span>
  </foreignObject>

  <foreignObject x="335" y="100" width="50" height="50">
  <span style="font-size: 50%; color: black;">$g_{jp}$</span>
  </foreignObject>
 </g>
</svg>
                    <!-- }}} -->
                </section>

                <section>
                    <p>誤差に基づく学習法を適用すると、学習パターン${\bf x}_p$に対する誤差は出力層のユニット$l$の出力と教師信号$b_{lp}$の2乗和で定義される$$J_p = \frac{1}{2} \sum_l (g_{lp} - b_{lp})^2$$</p>
                    <p>全学習パターンに対する誤差は$$J = \sum_p J_p$$となり$J$を最小にするように重みを調整する</p>
                    <p>重みの調整は確率的最急降下法$w_{ij}' = w_{ij} - \rho \frac{\partial J_p}{\partial w_{ij}}$によって行う</p>
                </section>

                <section>
                    <p>$\frac{\partial J_p}{\partial w_{ij}}$はユニット$j$とユニット$i$の結合重みを変化させた時の、誤差$J_p$の変化量を表している</p>
                    <p>ユニット$j$の出力は最終的な出力に影響をあたえるので、誤差$J_p$はユニット$j$の出力$h_{jp} = \sum_i w_{ij} g_{ip}$の関数といえる。<br />よって
                    $\frac{\partial J_p}{\partial w_{ij}} = \frac{\partial J_p}{\partial h_{jp}} \frac{\partial h_{jp}}{\partial w_{ij}} = \frac{\partial J_p}{\partial h_{jp}} g_{ip} \;\; (\because h_{jp} = \sum_i w_{ij} g_{ip})$</p>
                </section>

                <section>
                    <p>$\epsilon_{jp} = \frac{\partial J_p}{\partial h_{jp}}$とおくと、
                    $$\epsilon_{jp} = \frac{\partial J_p}{\partial g_{jp}} \frac{\partial g_{jp}}{\partial h_{jp}} = \frac{\partial J_p}{\partial g_{jp}} f'(h_{jp}) \;\; (\because g_{jp} = f(h_{jp}))$$</p>
                    <p>$f$に閾値関数を用いると微分できないので、代わりにシグモイド関数$s(x) = \frac{1}{1 + e^{-x}}$を用いると
                    $$ f'(h_{jp}) = f(h_{jp})(1 - f(h_{jp})) = g_{jp}(1 - g_{jp}) \;\; (\because s'(x) = s(x)(1 - s(x)))$$</p>
                    <p>よって、$ \epsilon_{jp} = \frac{\partial J_p}{\partial g_{jp}} g_{jp}(1 - g_{jp})$</p>
                    <p>$\frac{\partial J_p}{\partial g_{jp}}$はユニット$j$が出力層か中間層かで求め方が異なる</p>
                </section>

                <section>
                    <p>ユニット$j$が出力層の場合は$j = l$なので、$J_p = \frac{1}{2} \sum_l (g_{lp} - b_{lp})^2$より
                    $$ \frac{\partial J_p}{\partial g_{jp}} = g_{jp} - b_{jp} $$</p>
                    <p>ユニット$j$が中間層の場合は、ユニット$j$からの出力が複数の上位ユニット$k$の入力になっているので足しあわせて
                    $$ \frac{\partial J_p}{\partial g_{jp}} = \sum_k \frac{\partial J_p}{\partial h_{kp}} \frac{\partial h_{kp}}{\partial g_{jp}} = \sum_k \epsilon_{kp} w_{jk} $$
                    $$ (\because \epsilon_{jp} = \frac{\partial J_p}{\partial h_{jp}}, \;\; h_{kp} = \sum_i w_{jk} g_{jp}) $$</p>
                </section>

                <section>
                    <p>各ユニットにおける誤差の変化量$\epsilon_{jp}$は
                    $$ \epsilon_{jp} = \left\{ \begin{array}{ll}
                    (g_{jp} - b_{jp})g_{jp}(1 - g_{jp}) & (出力層)\\
                    (\sum_k \epsilon_{kp} w_{jk}) g_{jp} (1 - g_{jp}) & (中間層)
                    \end{array} \right. $$</p>
                    <p>よって$\frac{\partial J_p}{\partial w_{ij}} = \frac{\partial J_p}{\partial h_{jp}} \frac{\partial h_{jp}}{\partial w_{ij}} = \frac{\partial J_p}{\partial h_{jp}} g_{ip} = \epsilon_{jp} g_{ip}$
                    を用いて重みを更新していく</p>
                    <p>重みの更新は一定回数以上繰り返されるか、更新量が一定値以下になれば停止する</p>
                    <p>確率的最急降下法を用いているので局所解に陥る可能性がある</p>
                </section>
			</div>

		</div>

		<script src="../lib/js/head.min.js"></script>
		<script src="../js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,
				slideNumber: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: '../lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: '../plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: '../plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: '../plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: '../plugin/math/math.js', async: true },
					{ src: 'http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML', async: true }
				]
			});
			Reveal.addEventListener( 'slidechanged', function( event ) {
				MathJax.Hub.Rerender(event.currentSlide);
				MathJax.Hub.Config({
					"HTML-CSS": {
						scale: 80
					}
				});
				// if (event.indexh == 4 && event.indexv == 5) {
				// 	// Reveal.configure({ center: false });
				// } else {
				// 	Reveal.configure({ center: true });
				// }
			} );
		</script>

	</body>
</html>
